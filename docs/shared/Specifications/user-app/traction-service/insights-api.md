# Coaching Insights API

**Service:** Traction Service  
**Version:** v1.0  
**Last Updated:** February 2, 2026

## Overview

The Coaching Insights API provides endpoints for managing AI-generated coaching insights and recommendations. These insights are generated by the Python Coaching Service using the KISS framework (Keep, Improve, Start, Stop) and persisted in the Traction Service for retrieval and management.

**Architecture Flow:**
1. Frontend calls Python Coaching Service (`POST /insights/generate`) to generate insights
2. Python AI analyzes business data and returns insights with `kiss_category` and alignment analysis
3. Frontend persists insights to Traction Service (`POST /insights/batch`)
4. Subsequent retrievals fetch from Traction Service (no AI regeneration)
5. Widget displays insights grouped by KISS category

---

## Table of Contents

- [Save Coaching Insights Batch](#save-coaching-insights-batch)
- [Get All Coaching Insights](#get-all-coaching-insights)
- [Get Coaching Insight by ID](#get-coaching-insight-by-id)
- [Update Coaching Insight](#update-coaching-insight)
- [Delete Coaching Insight](#delete-coaching-insight)

---

## Save Coaching Insights Batch

**POST** `/traction/api/v1/insights/batch`

Save multiple coaching insights in a single batch operation. Typically called after generating insights from the Python Coaching Service.

### Request Body

```json
{
  "insights": [
    {
      "id": "insight_001",
      "title": "Focus on Enterprise Segment",
      "description": "Analysis shows 40% higher conversion rates in enterprise segment. This represents a significant opportunity to improve revenue quality and customer lifetime value.",
      "category": "strategy",
      "priority": "high",
      "kiss_category": "start",
      "alignment_impact": "This insight directly supports our growth objectives by targeting higher-value customer segments that align with our core competencies.",
      "status": "active",
      "created_at": "2026-02-02T23:09:51.327Z",
      "metadata": {
        "business_impact": "high",
        "effort_required": "medium"
      }
    },
    {
      "id": "insight_002",
      "title": "Maintain Strong Customer Support",
      "description": "Customer satisfaction scores remain consistently high (4.8/5). Support team responsiveness is a key differentiator.",
      "category": "operations",
      "priority": "medium",
      "kiss_category": "keep",
      "alignment_impact": "Maintaining excellent customer support reinforces our value proposition and drives retention.",
      "status": "active",
      "created_at": "2026-02-02T22:30:00.000Z",
      "metadata": {
        "business_impact": "high",
        "effort_required": "low"
      }
    }
  ]
}
```

### Request Field Definitions

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `insights` | array | Yes | Array of coaching insight objects to save |
| `insights[].id` | string | No | Unique insight ID (auto-generated if not provided) |
| `insights[].title` | string | Yes | Short, actionable insight title |
| `insights[].description` | string | Yes | Detailed explanation of the insight |
| `insights[].category` | string | Yes | Insight category: "strategy", "operations", "finance", "marketing", "leadership", "technology" |
| `insights[].priority` | string | Yes | Priority level: "low", "medium", "high", "critical" |
| `insights[].kiss_category` | string | Yes | KISS framework: "keep", "improve", "start", "stop" |
| `insights[].alignment_impact` | string | No | How this relates to business purpose/values |
| `insights[].status` | string | No | Status (defaults to "active"): "active", "dismissed", "acknowledged", "in_progress", "completed" |
| `insights[].created_at` | string | No | ISO 8601 timestamp (auto-generated if not provided) |
| `insights[].updated_at` | string | No | ISO 8601 timestamp (auto-generated if not provided) |
| `insights[].metadata.business_impact` | string | No | Business impact: "low", "medium", "high" |
| `insights[].metadata.effort_required` | string | No | Effort required: "low", "medium", "high" |

### Response

```json
{
  "success": true,
  "data": {
    "savedCount": 2,
    "insights": [
      {
        "id": "insight_001",
        "tenantId": "123e4567-e89b-12d3-a456-426614174000",
        "title": "Focus on Enterprise Segment",
        "description": "Analysis shows 40% higher conversion rates...",
        "category": "strategy",
        "priority": "high",
        "kiss_category": "start",
        "alignment_impact": "This insight directly supports our growth objectives...",
        "status": "active",
        "businessImpact": "high",
        "effortRequired": "medium",
        "createdAt": "2026-02-02T23:09:51.327Z",
        "updatedAt": "2026-02-02T23:09:51.327Z"
      },
      {
        "id": "insight_002",
        "tenantId": "123e4567-e89b-12d3-a456-426614174000",
        "title": "Maintain Strong Customer Support",
        "description": "Customer satisfaction scores remain consistently high...",
        "category": "operations",
        "priority": "medium",
        "kiss_category": "keep",
        "alignment_impact": "Maintaining excellent customer support...",
        "status": "active",
        "businessImpact": "high",
        "effortRequired": "low",
        "createdAt": "2026-02-02T22:30:00.000Z",
        "updatedAt": "2026-02-02T22:30:00.000Z"
      }
    ]
  },
  "error": null
}
```

### Response Field Definitions

| Field | Type | Description |
|-------|------|-------------|
| `data.savedCount` | number | Number of insights successfully saved |
| `data.insights` | array | Array of saved insight objects with all fields |
| `data.insights[].tenantId` | string | Tenant ID (auto-populated from auth context) |

**Notes:**
- Backend auto-generates `id` (GUID) if not provided
- Backend auto-generates timestamps if not provided
- Default status is "active" if not specified
- All fields are persisted exactly as provided (no enum validation)
- Metadata fields are flattened in response (businessImpact vs metadata.business_impact)

**Status Codes:**
- `200 OK` - Insights saved successfully
- `400 Bad Request` - Invalid request data (missing required fields)
- `401 Unauthorized` - Missing or invalid authentication token
- `500 Internal Server Error` - Server error during save operation

---

## Get All Coaching Insights

**GET** `/traction/api/v1/insights`

Retrieve all coaching insights for the authenticated tenant.

### Query Parameters

None. Returns all insights for the authenticated tenant (from X-Tenant-Id header).

### Response

```json
{
  "success": true,
  "data": [
    {
      "id": "insight_001",
      "tenantId": "123e4567-e89b-12d3-a456-426614174000",
      "title": "Focus on Enterprise Segment",
      "description": "Analysis shows 40% higher conversion rates in enterprise segment...",
      "category": "strategy",
      "priority": "high",
      "kiss_category": "start",
      "alignment_impact": "This insight directly supports our growth objectives...",
      "status": "active",
      "businessImpact": "high",
      "effortRequired": "medium",
      "createdAt": "2026-02-02T23:09:51.327Z",
      "updatedAt": "2026-02-02T23:09:51.327Z"
    }
  ],
  "error": null
}
```

**Status Codes:**
- `200 OK` - Insights retrieved successfully (empty array if none found)
- `401 Unauthorized` - Missing or invalid authentication token
- `500 Internal Server Error` - Server error during retrieval

---

## Get Coaching Insight by ID

**GET** `/traction/api/v1/insights/{id}`

Retrieve a specific coaching insight by its ID.

### URL Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | string | Yes | Coaching insight ID |

### Response

```json
{
  "success": true,
  "data": {
    "id": "insight_001",
    "tenantId": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Focus on Enterprise Segment",
    "description": "Analysis shows 40% higher conversion rates in enterprise segment...",
    "category": "strategy",
    "priority": "high",
    "kiss_category": "start",
    "alignment_impact": "This insight directly supports our growth objectives...",
    "status": "active",
    "businessImpact": "high",
    "effortRequired": "medium",
    "createdAt": "2026-02-02T23:09:51.327Z",
    "updatedAt": "2026-02-02T23:09:51.327Z"
  },
  "error": null
}
```

**Status Codes:**
- `200 OK` - Insight found and returned
- `404 Not Found` - Insight ID does not exist
- `401 Unauthorized` - Missing or invalid authentication token
- `500 Internal Server Error` - Server error during retrieval

---

## Update Coaching Insight

**PUT** `/traction/api/v1/insights/{id}`

Update an existing coaching insight. Supports partial updates.

### URL Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | string | Yes | Coaching insight ID to update |

### Request Body

```json
{
  "title": "Updated Insight Title",
  "description": "Updated description text",
  "priority": "critical",
  "status": "in_progress"
}
```

### Request Field Definitions

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `title` | string | No | Updated title (partial update) |
| `description` | string | No | Updated description (partial update) |
| `priority` | string | No | Updated priority: "low", "medium", "high", "critical" |
| `status` | string | No | Updated status: "active", "dismissed", "acknowledged", "in_progress", "completed" |

**Notes:**
- Only provided fields are updated
- `kiss_category`, `category`, `alignment_impact`, and metadata fields are not updatable (set at creation)
- `updated_at` timestamp is automatically updated

### Response

```json
{
  "success": true,
  "data": {
    "id": "insight_001",
    "tenantId": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Updated Insight Title",
    "description": "Updated description text",
    "category": "strategy",
    "priority": "critical",
    "kiss_category": "start",
    "alignment_impact": "This insight directly supports our growth objectives...",
    "status": "in_progress",
    "businessImpact": "high",
    "effortRequired": "medium",
    "createdAt": "2026-02-02T23:09:51.327Z",
    "updatedAt": "2026-02-03T10:15:22.123Z"
  },
  "error": null
}
```

**Status Codes:**
- `200 OK` - Insight updated successfully
- `404 Not Found` - Insight ID does not exist
- `400 Bad Request` - Invalid request data
- `401 Unauthorized` - Missing or invalid authentication token
- `500 Internal Server Error` - Server error during update

---

## Delete Coaching Insight

**DELETE** `/traction/api/v1/insights/{id}`

Delete a coaching insight permanently.

### URL Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | string | Yes | Coaching insight ID to delete |

### Response

```json
{
  "success": true,
  "data": null,
  "error": null
}
```

**Status Codes:**
- `200 OK` - Insight deleted successfully
- `404 Not Found` - Insight ID does not exist
- `401 Unauthorized` - Missing or invalid authentication token
- `500 Internal Server Error` - Server error during deletion

---

## Common Patterns

### KISS Framework Categories

Insights are categorized using the KISS framework for strategic clarity:

- **Keep**: Things working well that should continue (maintain strengths)
- **Improve**: Areas needing optimization (enhance existing capabilities)
- **Start**: New initiatives or opportunities (begin new activities)
- **Stop**: Activities to discontinue (eliminate waste)

### Purpose Alignment

Each insight includes `alignment_impact` explaining how it relates to:
- Business purpose and vision
- Core values
- Strategic goals
- Employee engagement, customer loyalty, and bottom-line impact

### Metadata Fields

The `metadata` object (flattened in responses) provides decision-making context:
- `business_impact`: Potential impact on business outcomes
- `effort_required`: Resources/time needed to address the insight

These help prioritize which insights to act on first (high impact + low effort = quick wins).

---

## Frontend Integration

**Service Location:** `src/services/api.ts`

**Implementation Methods:**
- `saveCoachingInsights(insights)` - POST /insights/batch
- `getCoachingInsights()` - GET /insights
- `getCoachingInsight(id)` - GET /insights/{id}
- `updateCoachingInsight(id, updates)` - PUT /insights/{id}
- `deleteCoachingInsight(id)` - DELETE /insights/{id}

**Related Services:**
- Python Coaching Service: Generates insights (see [Coaching Service Spec](../coaching-service.md))
- Dashboard Widget: Displays insights (see [Dashboard Service Spec](../dashboard-service.md#ai-insights-widget))

---

## Error Handling

All endpoints return consistent error responses:

```json
{
  "success": false,
  "data": null,
  "error": "Error message describing what went wrong",
  "code": null,
  "details": null
}
```

**Common Errors:**
- Missing `kiss_category` field → 400 Bad Request
- Invalid tenant ID → 401 Unauthorized
- Insight not found → 404 Not Found
- Database errors → 500 Internal Server Error
