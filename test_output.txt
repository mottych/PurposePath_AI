
============================================================
PurposePath Website Scanning Test Suite
============================================================

============================================================
STEP 1: Testing Bedrock Configuration
============================================================
✅ AWS credentials configured
✅ Bedrock client created (Region: us-east-1)
✅ Bedrock access verified (24 Anthropic models available)
   Available models: ['anthropic.claude-sonnet-4-20250514-v1:0', 'anthropic.claude-haiku-4-5-20251001-v1:0', 'anthropic.claude-sonnet-4-5-20250929-v1:']

============================================================
STEP 2: Testing Website Content Fetching
============================================================
Fetching: https://purposepath.ai
✅ HTTP 200 - 1373627 characters
✅ Page title: AI Business Coach – Connect Purpose, Vision & Execution | Purpose Path
✅ Meta description found: Purpose Path - AI business coach & alignment platform for small and midsize comp...

============================================================
STEP 3: Testing Website Scanning Service
============================================================
Analyzing: https://purposepath.ai
Initializing LLM provider...
Adding Bedrock provider...
{"provider_id": "bedrock", "provider_type": "bedrock", "event": "Provider registered", "level": "info", "timestamp": "2025-11-18T22:40:59.956498Z"}
{"event": "Initializing provider manager", "level": "info", "timestamp": "2025-11-18T22:40:59.956498Z"}
{"provider_id": "bedrock", "provider_type": "bedrock", "event": "Initializing provider", "level": "info", "timestamp": "2025-11-18T22:40:59.956498Z"}
{"model": "anthropic.claude-3-sonnet-20240229-v1:0", "event": "Initializing Bedrock provider", "level": "info", "timestamp": "2025-11-18T22:40:59.956498Z"}
{"event": "Bedrock provider initialized successfully", "level": "info", "timestamp": "2025-11-18T22:41:00.368630Z"}
{"provider_count": 1, "event": "Provider manager initialized", "level": "info", "timestamp": "2025-11-18T22:41:00.368630Z"}
✅ Provider manager initialized with Bedrock
{"event": "Website analysis service initialized", "level": "info", "timestamp": "2025-11-18T22:41:00.368630Z"}
✅ Analysis service created
Analyzing website content with AI (this may take 10-30 seconds)...
{"url": "https://purposepath.ai", "event": "Starting website analysis", "level": "info", "timestamp": "2025-11-18T22:41:00.368630Z"}
{"url": "https://purposepath.ai", "title": "AI Business Coach \u2013 Connect Purpose, Vision & Execution | Purpose Path", "content_length": 3619, "event": "Website content extracted", "level": "info", "timestamp": "2025-11-18T22:41:01.207358Z"}
{"url": "https://purposepath.ai", "error": "'BedrockProvider' object has no attribute 'generate_response'", "event": "LLM analysis failed", "level": "error", "timestamp": "2025-11-18T22:41:01.207358Z"}
Traceback (most recent call last):
  File "C:\Projects\XBS\PurposePath\PurposePath_Api\pp_ai\coaching\src\services\website_analysis_service.py", line 99, in analyze_website
    analysis_result = await self._analyze_with_llm(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Projects\XBS\PurposePath\PurposePath_Api\pp_ai\coaching\src\services\website_analysis_service.py", line 293, in _analyze_with_llm
    response_text = await provider.generate_response(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BedrockProvider' object has no attribute 'generate_response'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Projects\XBS\PurposePath\PurposePath_Api\pp_ai\test_website_scan.py", line 141, in test_website_scanning_service
    analysis = await analysis_service.analyze_website(url)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Projects\XBS\PurposePath\PurposePath_Api\pp_ai\coaching\src\services\website_analysis_service.py", line 107, in analyze_website
    raise RuntimeError(f"AI analysis failed: {e!s}") from e
RuntimeError: AI analysis failed: 'BedrockProvider' object has no attribute 'generate_response'
❌ Error during website scanning: AI analysis failed: 'BedrockProvider' object has no attribute 'generate_response'

============================================================
TEST SUMMARY
============================================================
Bedrock Configuration: ✅ PASS
Website Fetching:      ✅ PASS
AI Website Scanning:   ❌ FAIL
============================================================
